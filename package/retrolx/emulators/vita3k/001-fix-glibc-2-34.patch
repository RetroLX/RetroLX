From 01f3ad92df8cefc3e0a86bd14ac1815ae1832204 Mon Sep 17 00:00:00 2001
From: Marshall Mohror <mohror64@gmail.com>
Date: Mon, 20 Sep 2021 22:28:48 -0500
Subject: [PATCH] Fix `signal_stack_size` for glibc 2.34

`SIGSTKSZ` is now defined as `sysconf(_SC_SIGSTKSZ)` which is not constexpr, and returns a long which throws off the `std::max` template deduction.

Signed-off-by: Enrico Belleri <idesmi@protonmail.com>
---
 external/dynarmic/src/dynarmic/backend/x64/exception_handler_posix.cpp | 2 +-
 external/dynarmic/src/dynarmic/backend/A64/exception_handler_posix.cpp | 2 +-
 2 file changed, 2 insertion(+), 2 deletion(-)

diff --git a/external/dynarmic/src/dynarmic/backend/x64/exception_handler_posix.cpp b/external/dynarmic/src/dynarmic/backend/x64/exception_handler_posix.cpp
index ff01ab606..bdaac0c3e 100644
--- a/external/dynarmic/src/dynarmic/backend/x64/exception_handler_posix.cpp
+++ b/external/dynarmic/src/dynarmic/backend/x64/exception_handler_posix.cpp
@@ -64,7 +64,7 @@ class SigHandler {
 SigHandler sig_handler;
 
 SigHandler::SigHandler() {
-    constexpr size_t signal_stack_size = std::max(SIGSTKSZ, 2 * 1024 * 1024);
+    const size_t signal_stack_size = std::max<size_t>(SIGSTKSZ, 2 * 1024 * 1024);
 
     signal_stack_memory = std::malloc(signal_stack_size);

